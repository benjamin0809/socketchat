(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{Cf5d:function(n,t,e){"use strict";e.r(t);var l=e("8Y7J");class i{}var s=e("pMnS"),r=e("h5Qc"),o=e("qIgY"),a=e("n90K"),u=e("6m4Z"),c=e("riPR"),g=e("TY44"),d=e("4DE5"),h=e("cUpR"),b=e("oBZk"),p=e("ZZ/e"),m=e("SVse"),f=e("s7LF"),M=e("mrSG"),C=e("OlR4"),x=e("VvKu"),v=e("bl9C"),P=e("w6Z3"),_=e("sj5I"),S=e("IfSK"),O=e("Zr1d"),k=e("VGsI"),w=e("fg/S"),E=e("ZwiA");class y{constructor(n,t,e,l,i,s,r,o,a,u,c,g,d,h,b,p,m,M,C,x,v,P,_){this.navParams=n,this.navCtrl=t,this.formBuilder=e,this.session=l,this.messageProvider=i,this.sanitizer=s,this.storageService=r,this.element=o,this.nativeService=a,this.keyboard=u,this.preloadProvider=c,this.eventsService=g,this.alertCtrl=d,this.translateService=h,this.widgetProvider=b,this.clipboard=p,this.preload=m,this.cacheProvider=M,this.actionSheetCtrl=C,this.modal=x,this.cd=v,this.router=P,this.commonService=_,this.limit=15,this.offset=0,this.toUser={_id:"initialId",pic:"assets/imgs/logo.png",username:"reveiceUser"},this.user={_id:"initialId",pic:"assets/imgs/logo.png",username:"currentUser"},this.isShowChooser=!1,this.isSending=!1,this.messages=[],this.isTyping=!1,this.topId="",this.messageForm=e.group({message:new f.e("")}),this.keyboard.onKeyboardWillShow().subscribe(n=>{this.nativeService.isAndroid()&&this.setFooterPosition(this.session.keyboardHeight||243),this.ContentResize()}),this.keyboard.onKeyboardWillHide().subscribe(n=>{this.nativeService.isAndroid()&&this.setFooterPosition(0)}),this.navParams.data.messages&&(this.messages=this.navParams.data.messages.concat(this.messages),this.refreshDisplaytime(),this.transHtml(),this.ContentResize())}ionViewCanEnter(){if(this.session&&this.session.userId&&"50709171857408"===this.session.userId)return"Beta"===this.session.user.nickName||(this.nativeService.showToast(this.translateService.instant("APP_COMMON_DISABLE_FUCTION")),!1)}ngOnInit(){this.keyboard.setResizeMode(O.b.Body),this.nativeService.hideKeyboardAccessoryBar(!0),this.toUser._id=this.navParams.data.widgetId||"bot_001",this.session.messageWidgetId=this.navParams.data.widgetId||"bot_001",this.toUser.pic=this.navParams.data.widgetIcon||this.toUser.pic,this.toUser.username=this.navParams.data.widgetName||"bot",this.chatBox="",this.messageTitle=this.navParams.data.widgetName,this.user.pic=this.session.user?this.session.user.pictureUrl:this.user.pic,this.user._id=this.session.userId,this.navParams.data.messages||this.createArray(),this.eventsService.on(x.k.AddMessage,n=>{-1===this.messages.findIndex(t=>t.id===n.id)&&(this.messages.push(n),this.transHtml(),this.scrollToBottom(),this.cd.detectChanges())})}ionViewWillUnload(){this.eventsService.off(x.k.AddMessage)}lowerCaseFormatType(n){return n?n.toLowerCase():""}ionViewDidLeave(){this.keyboard.setResizeMode(O.b.None),this.nativeService.hideKeyboardAccessoryBar(!1)}cancelTyping(){this.isShowChooser=!1,this.ContentResize(),this.cd.detectChanges()}blurInput(){setTimeout(()=>{this.isSending||this.isShowChooser||(this.ContentResize(),this.cd.detectChanges())},10)}focusInput(){this.isShowChooser=!1}ionViewWillEnter(){}FormSubmit(n){}send(n){n&&n.replace(/\s+/g,"")&&(this.isSending=!0,this.sendMessage(n,"text"),this.myInput.setFocus(),this.cd.detectChanges(),setTimeout(()=>{this.isSending=!1},30))}sendImageMessage(n,t,e,l){(n||this).sendMessage(e,"image",t)}sendMessage(n,t,e){if(n&&""!==n){const l={widgetId:0,id:this.session.userId+Date.now(),userId:this.user._id,widgetName:this.toUser.username,imageUrl:e,widgetIcon:this.toUser.pic,abstract:n,receiveTime:Date.now().toString(),formatType:t,isRead:!0,isSend:!0,status:this.messageProvider.STAUTS.SEND_MESSAGE_SENDING,extra:{groudId:0,senderAvator:this.user.pic,senderName:this.session.user.userName,senderId:Number(this.toUser._id),fromType:"Chat"}};this.messageProvider.insertMessage(l),this._sendMessageFromMessageProvider(l),this.messages.push(l),this.transHtml(),this.scrollToBottom()}this.chatBox="",this.refreshDisplaytime()}_sendMessageFromMessageProvider(n){this.messageProvider.sendMessage(n).subscribe(t=>{this._updateMessageStatus(t?this.messageProvider.STAUTS.SEND_MESSAGE_OK:this.messageProvider.STAUTS.SEND_MESSAGE_FAILED,n)},t=>{this._updateMessageStatus(this.messageProvider.STAUTS.SEND_MESSAGE_FAILED,n)})}_updateMessageStatus(n,t){this.messageProvider.updateMessageStatus(n,t).subscribe(e=>{const l=this.messages.findIndex(n=>n.id===t.id);l>-1&&(this.messages[l].status=n)})}reSendMessage(n){return M.b(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:this.translateService.instant("MESSAGE_CHAT_RESEND"),buttons:[{text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),handler:()=>{}},{text:this.translateService.instant("MESSAGE_DELETE_CONFIRM"),handler:()=>{const t=this.messages.findIndex(t=>t.id===n.id);t>-1&&(n.receiveTime=Date.now().toString(),n.status=this.messageProvider.STAUTS.SEND_MESSAGE_SENDING,this.messages.splice(t,1),this.messages.push(n),this.refreshDisplaytime(),this.messageProvider.updateMessage(n).subscribe(t=>{this._sendMessageFromMessageProvider(n)}))}}]});yield t.present()}))}AlterSendMessage(n,t){this.messageProvider.insertMessage(n),t?this.messageProvider.sendMessage(n).subscribe():this.messageProvider.receiveMessageNew(n),this.messages.push(n),this.transHtml(),this.scrollToBottom()}scrollToBottom(n=300){setTimeout(()=>{this.content.scrollToBottom(n)},10)}setInputHeight(n=36){this.myInput._elementRef.nativeElement.style.height=n+"px"}doRefresh(n){this.messages&&this.messages.length>0&&(this.topId=this.messages[0].id),this.createArray(n)}refreshDisplaytime(){let n=0,t=null;for(const e of this.messages){const l=Number(e.receiveTime);if(e.displayTime=k.a.formatMessageTime(this.session.language,l),n>0){const n=l;n-t>18e4?t=n:e.displayTime=""}else t=l;n++}}scrollTopByHandle(){this.topId&&this.element.nativeElement.querySelector(`#messageid-${this.topId}`)}transHtml(){for(const n of this.messages)n.abstract&&(n.displayAbstract=this.messageProvider.transformHtml(n.abstract),n.displayAbstract=this.sanitizer.bypassSecurityTrustHtml(n.displayAbstract))}abstractOnClick(n,t){n.stopPropagation();const e=n.target||n.srcElement;this.goMessageDetail(t,"javascript:void(0)"===e.href?e.title||e.innerText:"")}onHold(n){let t=null;const e=[];e.push({text:this.translateService.instant("MESSAGE_DELETE"),handler:()=>{this.showDeleteMsg(n)}}),n.redirectUrl||n.formatType.indexOf("Image")>-1?e.push({text:this.translateService.instant("SHARE_MODAL_TITLE"),handler:()=>{this.openSharePage(n)}}):e.push({text:this.translateService.instant("APP_COMMON_COPY_MESSAGE"),handler:()=>{this.clipboard.copy(n.abstract)}}),e.push({text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),role:"cancel"}),this.cacheProvider.decodeQRCode(n.imageUrl).subscribe(l=>M.b(this,void 0,void 0,(function*(){e.splice(e.length-1,1,{text:this.translateService.instant("APP_COMMON_EXTRACT_QRCODE"),handler:()=>{this.openQRCodeUrl(l,n)}}),e.push({text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),role:"cancel"});const i=yield this.actionSheetCtrl.create({buttons:e});yield i.present(),t&&t.dismiss()})),n=>{(t=this.actionSheetCtrl.create({buttons:e})).present()})}showDeleteMsg(n){return M.b(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:this.translateService.instant("MESSAGE_DELETE_TITLE"),message:this.translateService.instant("MESSAGE_DELETE_MESSAGE"),buttons:[{text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),handler:()=>{}},{text:this.translateService.instant("MESSAGE_DELETE_CONFIRM"),handler:()=>{const t=this.messages.findIndex(t=>t.id===n.id);this.messages.splice(t,1),this.messageProvider.deleteMessage(n.id)}}]});yield t.present()}))}openSharePage(n){this.commonService.openShareModal({shareMessage:{title:n.title,description:n.abstract,thumb:n.imageUrl||v.k,resource:n.redirectUrl||n.imageUrl},callback:n=>{},isShareImage:!n.redirectUrl,navigationDockTargetMapIds:[1,2]})}openQRCodeUrl(n,t){const e={url:n,title:t.title,description:t.abstract,imageUrl:t.imageUrl,appId:t.widgetId.toString(),options:{}};this.widgetProvider.openWebpage(e,this.router)}goMessageDetail(n,t){if(n.isRead=!0,this.messageProvider.setMessageIsRead(n.id),!n.redirectUrl&&!t)return;const e={url:t||n.redirectUrl,title:null==n.title?n.widgetName:n.title,description:n.abstract,imageUrl:n.imageUrl,appId:null==n.widgetId?"":n.widgetId.toString(),options:{}};this.widgetProvider.openWebpage(e,this.router,!0)}getPictureByPhotoLibrary(n){n.stopPropagation(),this.nativeService.isMobile()?this.nativeService.getFullPictureByPhotoLibrary({}).subscribe(n=>{this.nativeService.compressImage(n,{MaxWidthOrHeight:1024}).subscribe(n=>{this.sendImageMessage(this,n.dataURL,"Image")})},n=>{this.nativeService.showToast(n)}):k.a.generateQRCode("https://iproud.fihmb.com/Resources/Widgets/66295698871296.png").then(n=>{this.sendImageMessage(this,n,"Image")})}getPictureByCamera(n){n.stopPropagation(),this.nativeService.isMobile()?this.nativeService.getFullPictureByCamera({}).subscribe(n=>{this.nativeService.compressImage(n,{MaxWidthOrHeight:1024}).subscribe(n=>{this.sendImageMessage(this,n.dataURL,"Image")})},n=>{this.nativeService.showToast(n)}):k.a.generateQRCode("https://iproud.fihmb.com/Resources/Widgets/66295698871296.png").then(n=>{this.sendImageMessage(this,n,"Image")})}showOptions(){return M.b(this,void 0,void 0,(function*(){this.cd.detectChanges(),this.ContentResize();const n=yield this.modal.create({component:"MessageImagePickerPage",componentProps:{callback:this.sendImageMessage,scope:this},cssClass:"pick-modal"});yield n.present()}))}ContentResize(){setTimeout(()=>{setTimeout(()=>{this.scrollToBottom()},50)},50)}setFooterPosition(n){this.footer.nativeElement.style.setProperty("padding-bottom",`${n}px`,"important"),this.ContentResize(),this.cd.detectChanges()}getFooterPaddingBottomHeight(){return this.footer.nativeElement.style.getPropertyValue("padding-bottom")}clickOnImage(n,t){t.stopPropagation();const e=[];for(const l of this.messages)"image"===l.formatType.toLowerCase()&&e.push({id:l.id,pictureUrl:l.imageUrl});if(e.length>0){const t=e.findIndex(t=>t.id===n.id);this.preloadProvider.previewImage({pictures:e,index:t})}}openMemberPage(n){this.router.navigate(["ContactDetailPage"],{state:{friendId:n}})}createArray(n){this.messageProvider.queryMessage(this.toUser._id,this.limit,this.messages.length||this.offset).subscribe(n=>{n&&(this.messages=n.concat(this.messages),this.refreshDisplaytime(),this.transHtml(),setTimeout(()=>{this.scrollTopByHandle()},10))}),n&&n.target.complete()}shareContactCard(){this.preload.openContactChooserPage({callback:this.AfterShare,type:1})}AfterShare(n){return M.b(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:"Share contact card",message:n[0].name,buttons:[{text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),handler:()=>{}},{text:this.translateService.instant("MESSAGE_DELETE_CONFIRM"),handler:()=>{const t={widgetId:0,id:n[0].id,userId:this.user._id,widgetName:this.toUser.username,imageUrl:n[0].avator,widgetIcon:this.toUser.pic,abstract:n[0].name,receiveTime:Date.now().toString(),formatType:"card",isRead:!0,isSend:!0,status:"success"};this.AlterSendMessage(t,!0)}}]});yield t.present()}))}}var I=e("TSSN"),T=e("iInd"),A=l.pb({encapsulation:0,styles:[['@charset "UTF-8";.bar-footer[_ngcontent-%COMP%]{overflow:visible!important}.bar-footer[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:none;height:25px}button.ion-android-send[_ngcontent-%COMP%]{padding-top:2px}.footer-btn[_ngcontent-%COMP%]{font-size:x-large}img.profile-pic[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;position:absolute;top:20px}img.profile-pic.left[_ngcontent-%COMP%]{left:10px}img.profile-pic.right[_ngcontent-%COMP%]{right:10px}.ion-email[_ngcontent-%COMP%]{float:right;font-size:32px;vertical-align:middle}.message[_ngcontent-%COMP%]{font-size:14px;word-break:break-all}.message-detail[_ngcontent-%COMP%]{white-space:nowrap;font-size:14px}.bar.item-input-inset[_ngcontent-%COMP%]   .item-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%!important}.message-wrapper[_ngcontent-%COMP%]{touch-action:inherit!important;position:relative}.message-wrapper[_ngcontent-%COMP%]:last-child{margin-bottom:10px}.chat-bubble[_ngcontent-%COMP%]{border-radius:5px;display:-webkit-inline-box;display:inline-flex;padding:10px 12px;position:relative;margin:10px}.chat-bubble[_ngcontent-%COMP%]:before{content:"\xa0";display:block;height:16px;width:9px;position:absolute;top:2.5px}.chat-bubble.left[_ngcontent-%COMP%]{float:left;margin-left:58px;margin-right:55px}.chat-bubble.left[_ngcontent-%COMP%]:before{left:-2px;-webkit-transform:rotate(50deg) skew(5deg);transform:rotate(50deg) skew(5deg)}.chat-bubble-container[_ngcontent-%COMP%]{float:right;margin-right:55px;margin-left:55px}.chat-bubble-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:15px 0;padding-right:5px}.chat-bubble.right[_ngcontent-%COMP%]{background-color:#158ffe;color:#fff;float:right}.chat-bubble-image-right[_ngcontent-%COMP%]{float:right;border-radius:2px;padding:10px 0}.chat-bubble-image-right[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;border-radius:5px}.chat-bubble-image-left[_ngcontent-%COMP%]{float:left;margin-right:55px;margin-left:55px;border-radius:2px;padding:10px 0}.chat-bubble-image-left[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;border-radius:5px}.chat-bubble.right[_ngcontent-%COMP%]:before{background-color:#158ffe;right:-1px;top:2.5px;-webkit-transform:rotate(135deg) skew(-5deg);transform:rotate(135deg) skew(-5deg)}.chat-bubble.right[_ngcontent-%COMP%]   a.autolinker[_ngcontent-%COMP%]{color:#fff;font-weight:700}.user-messages-top-icon[_ngcontent-%COMP%]{font-size:28px;display:inline-block;vertical-align:middle;position:relative;top:-3px;right:5px}.msg-header-username[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;position:relative;top:-3px}.bold[_ngcontent-%COMP%]{font-weight:700}.cf[_ngcontent-%COMP%]{clear:both!important}a.autolinker[_ngcontent-%COMP%]{color:#3b88c3;text-decoration:none}.loader-center[_ngcontent-%COMP%]{height:100%;display:-webkit-box;display:flex;-webkit-box-direction:normal;-webkit-box-orient:horizontal;flex-direction:row;flex-wrap:nowrap;-webkit-box-pack:center;justify-content:center;align-content:stretch;-webkit-box-align:center;align-items:center}.loader[_ngcontent-%COMP%]   .ion-loading-c[_ngcontent-%COMP%]{font-size:64px}ion-card[_ngcontent-%COMP%]{background-color:#fff}.card-ios[_ngcontent-%COMP%]{box-shadow:0 0 1px rgba(0,0,0,.3)}.card-ios-canClick[_ngcontent-%COMP%]{background:var(--bg-primary-color)!important;box-shadow:0 0 5px --text-primary-color}.label-ios[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{white-space:normal}.datetime[_ngcontent-%COMP%]{text-align:center;font-size:12px;margin-bottom:-5px;margin-top:10px}.no-datetime[_ngcontent-%COMP%]{text-align:center;color:#999;font-size:12px;margin-bottom:-5px;margin-top:0}.titleInImage[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem;line-height:16px;margin-top:-33px;z-index:2;padding:8px 5px;background-color:#fff;opacity:.8;position:relative;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.no-message[_ngcontent-%COMP%]{color:#838383;height:60px;padding:15px;text-align:center;font-size:12px}.no-more[_ngcontent-%COMP%]{text-align:center;color:#838383;height:60px;padding:15px;font-size:12px}.red-point[_ngcontent-%COMP%]{position:relative}.red-point[_ngcontent-%COMP%]::after{content:"\u25cf";position:absolute;z-index:2;left:0;margin-left:-16px;margin-top:0;color:#ae0000;font-size:90%}input[_ngcontent-%COMP%]{width:100%;border:0}.col[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:36px;height:36px}.col[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:0 0}.send-more-container[_ngcontent-%COMP%]{background-color:var(--bg-primary-color);height:243px;position:absolute;bottom:0;width:100%;z-index:99}.footer-container[_ngcontent-%COMP%]{-webkit-transition:.5s;transition:all .5s;-webkit-animation:.5s input;animation:.5s input;padding:0;border-bottom:none!important;border-top:var(--border-primary)}.footer-container[_ngcontent-%COMP%]   .footer-content[_ngcontent-%COMP%]{padding:5px}.footer-container[_ngcontent-%COMP%]   .item-ios[_ngcontent-%COMP%]{padding-left:5px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.footer-container[_ngcontent-%COMP%]   .item-ios[_ngcontent-%COMP%]   .item-block[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{border:0!important}.footer-container[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%]{padding:5px;border-radius:5px;font-size:1.5rem}.input-focus[_ngcontent-%COMP%], .input-focus[_ngcontent-%COMP%]   .toolbar-background[_ngcontent-%COMP%]{position:relative}.dark-theme[_ngcontent-%COMP%]   .item-input-wrapper[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{background-color:#555!important}.dark-theme[_ngcontent-%COMP%]   .scroll-content[_ngcontent-%COMP%]{background-color:transparent!important}.dark-theme[_ngcontent-%COMP%]   .card-content-ios[_ngcontent-%COMP%]{background:#555}.dark-theme[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%]{background-color:#555}.dark-theme[_ngcontent-%COMP%]   .datetime[_ngcontent-%COMP%]{color:#777}.dark-theme[_ngcontent-%COMP%]   .content-ios[_ngcontent-%COMP%]{color:#ccc}.dark-theme[_ngcontent-%COMP%]   .chat-bubble.left[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   .chat-bubble.left[_ngcontent-%COMP%]:before{background-color:#424242}.chat-bubble.left[_ngcontent-%COMP%], .chat-bubble.left[_ngcontent-%COMP%]:before{background-color:#e6e5eb}.scroll-content[_ngcontent-%COMP%]{background-color:#f6f6f6!important}.item-input[_ngcontent-%COMP%], .item-input-wrapper[_ngcontent-%COMP%], input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{background-color:#f4f4f4!important}.card-ios[_ngcontent-%COMP%], .item-ios[_ngcontent-%COMP%]{background:#fff!important}.datetime[_ngcontent-%COMP%]{color:#bbb}.card[_ngcontent-%COMP%]{margin:0}@-webkit-keyframes input{from{-webkit-transform:translateY(20%);transform:translateY(20%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes input{from{-webkit-transform:translateY(20%);transform:translateY(20%)}to{-webkit-transform:translateY(0);transform:translateY(0)}}']],data:{}});function U(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,2,"div",[["class","datetime "]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),l.Jb(2,null,["",""]))],null,(function(n,t){n(t,2,0,t.parent.context.$implicit.displayTime)}))}function B(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,2,"div",[["class","chat-bubble left slide-left"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,1,"div",[["class","toUser"]],null,null,null,null,null)),(n()(),l.rb(2,0,null,null,0,"div",[["class","message"]],[[8,"innerHTML",1]],[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.abstractOnClick(e,n.parent.parent.context.$implicit)&&l),l}),null,null))],null,(function(n,t){n(t,2,0,t.parent.parent.context.$implicit.displayAbstract)}))}function D(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,3,"div",[["class","chat-bubble-image-left  left slide-left"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,2,"div",[["class","toUser"]],null,null,null,null,null)),(n()(),l.rb(2,0,null,null,1,"img-lazy-load",[],null,[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.clickOnImage(n.parent.parent.context.$implicit)&&l),l}),r.b,r.a)),l.qb(3,638976,null,0,o.a,[a.a,l.h,u.a,c.a,g.a,d.a,h.b],{src:[0,"src"]},null)],(function(n,t){n(t,3,0,t.parent.parent.context.$implicit.imageUrl)}),null)}function q(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,12,"div",[["class","chat-bubble-image-left  left slide-left"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,11,"div",[["class","toUser"]],null,null,null,null,null)),(n()(),l.rb(2,0,null,null,6,"ion-item",[],null,null,null,b.Fb,b.y)),l.qb(3,49152,null,0,p.J,[l.h,l.k,l.x],null,null),(n()(),l.rb(4,0,null,0,2,"ion-avatar",[["item-start",""]],null,null,null,b.fb,b.b)),l.qb(5,49152,null,0,p.h,[l.h,l.k,l.x],null,null),(n()(),l.rb(6,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),l.rb(7,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),l.Jb(8,null,["",""])),(n()(),l.rb(9,0,null,null,3,"ion-item",[["no-lines",""]],null,null,null,b.Fb,b.y)),l.qb(10,49152,null,0,p.J,[l.h,l.k,l.x],null,null),(n()(),l.rb(11,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),l.Jb(-1,null,["Contact Card"]))],null,(function(n,t){n(t,6,0,t.parent.parent.context.$implicit.imageUrl),n(t,8,0,t.parent.parent.context.$implicit.abstract)}))}function L(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,10,"div",[],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,3,"img",[["class","profile-pic left"]],[[8,"src",4]],[[null,"click"]],(function(n,t,e){var l=!0,i=n.component;return"click"===t&&(l=!1!==i.openMemberPage(i.toUser._id)&&l),l}),null,null)),l.Gb(512,null,m.x,m.y,[l.k,l.r,l.B]),l.qb(3,278528,null,0,m.m,[m.x],{ngStyle:[0,"ngStyle"]},null),l.Fb(4,{top:0}),(n()(),l.gb(16777216,null,null,1,null,B)),l.qb(6,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),l.gb(16777216,null,null,1,null,D)),l.qb(8,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),l.gb(16777216,null,null,1,null,q)),l.qb(10,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null)],(function(n,t){var e=n(t,4,0,null!=t.parent.context.$implicit&&t.parent.context.$implicit.displayTime?"20px":"10px");n(t,3,0,e),n(t,6,0,"text"),n(t,8,0,"image"),n(t,10,0,"card")}),(function(n,t){n(t,1,0,t.component.toUser.pic)}))}function R(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,1,"ion-spinner",[["class","icon"],["name","lines-small"]],null,null,null,b.Yb,b.U)),l.qb(1,49152,null,0,p.ub,[l.h,l.k,l.x],{name:[0,"name"]},null)],(function(n,t){n(t,1,0,"lines-small")}),null)}function N(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,1,"ion-icon",[["class","icon"],["color","danger"],["name","alert"]],null,[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.reSendMessage(n.parent.parent.context.$implicit)&&l),l}),b.xb,b.t)),l.qb(1,49152,null,0,p.E,[l.h,l.k,l.x],{color:[0,"color"],name:[1,"name"]},null)],(function(n,t){n(t,1,0,"danger","alert")}),null)}function F(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,1,"div",[["class","chat-bubble right slide-right"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,0,"div",[["class","message"]],[[8,"innerHTML",1]],[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.abstractOnClick(e,n.parent.parent.context.$implicit)&&l),l}),null,null))],null,(function(n,t){n(t,1,0,t.parent.parent.context.$implicit.displayAbstract)}))}function z(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,1,"div",[["class"," chat-bubble-image-right right slide-right"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,0,"img",[],[[8,"src",4]],[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.clickOnImage(n.parent.parent.context.$implicit,e)&&l),l}),null,null))],null,(function(n,t){n(t,1,0,t.parent.parent.context.$implicit.imageUrl)}))}function $(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,13,"div",[["class"," chat-bubble-image-right right slide-right"]],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,8,"ion-list",[["class","card"]],null,null,null,b.Ib,b.D)),l.qb(2,49152,null,0,p.Q,[l.h,l.k,l.x],null,null),(n()(),l.rb(3,0,null,0,6,"ion-item",[["no-lines",""]],null,null,null,b.Fb,b.y)),l.qb(4,49152,null,0,p.J,[l.h,l.k,l.x],null,null),(n()(),l.rb(5,0,null,0,2,"ion-avatar",[["item-start",""]],null,null,null,b.fb,b.b)),l.qb(6,49152,null,0,p.h,[l.h,l.k,l.x],null,null),(n()(),l.rb(7,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),l.rb(8,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),l.Jb(9,null,["",""])),(n()(),l.rb(10,0,null,null,3,"ion-item",[["no-lines",""]],null,null,null,b.Fb,b.y)),l.qb(11,49152,null,0,p.J,[l.h,l.k,l.x],null,null),(n()(),l.rb(12,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),l.Jb(-1,null,["Contact Card"]))],null,(function(n,t){n(t,7,0,t.parent.parent.context.$implicit.imageUrl),n(t,9,0,t.parent.parent.context.$implicit.abstract)}))}function G(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,12,"div",[],null,null,null,null,null)),(n()(),l.rb(1,0,null,null,0,"img",[["class","profile-pic right"]],[[8,"src",4]],[[null,"click"]],(function(n,t,e){var l=!0,i=n.component;return"click"===t&&(l=!1!==i.openMemberPage(i.user._id)&&l),l}),null,null)),(n()(),l.rb(2,0,null,null,8,"div",[["class","chat-bubble-container"]],null,[[null,"press"]],(function(n,t,e){var l=!0;return"press"===t&&(l=!1!==n.component.onHold(n.parent.context.$implicit)&&l),l}),null,null)),(n()(),l.gb(16777216,null,null,1,null,R)),l.qb(4,16384,null,0,m.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(n()(),l.gb(16777216,null,null,1,null,N)),l.qb(6,16384,null,0,m.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(n()(),l.gb(16777216,null,null,1,null,F)),l.qb(8,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),l.gb(16777216,null,null,1,null,z)),l.qb(10,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(n()(),l.gb(16777216,null,null,1,null,$)),l.qb(12,278528,null,0,m.o,[l.M,l.J,m.n],{ngSwitchCase:[0,"ngSwitchCase"]},null)],(function(n,t){n(t,4,0,"sending"==t.parent.context.$implicit.status),n(t,6,0,"failed"==t.parent.context.$implicit.status),n(t,8,0,"text"),n(t,10,0,"image"),n(t,12,0,"card")}),(function(n,t){n(t,1,0,t.component.user.pic)}))}function J(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,9,"div",[["class","message-wrapper"]],[[8,"id",0]],null,null,null,null)),l.qb(1,16384,null,0,m.n,[],{ngSwitch:[0,"ngSwitch"]},null),(n()(),l.gb(16777216,null,null,1,null,U)),l.qb(3,16384,null,0,m.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(n()(),l.rb(4,0,null,null,2,"div",[],null,[[null,"press"]],(function(n,t,e){var l=!0;return"press"===t&&(l=!1!==n.component.onHold(n.context.$implicit)&&l),l}),null,null)),(n()(),l.gb(16777216,null,null,1,null,L)),l.qb(6,16384,null,0,m.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(n()(),l.gb(16777216,null,null,1,null,G)),l.qb(8,16384,null,0,m.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(n()(),l.rb(9,0,null,null,0,"div",[["class","cf"]],null,null,null,null,null))],(function(n,t){n(t,1,0,t.component.lowerCaseFormatType(t.context.$implicit.formatType)),n(t,3,0,null==t.context.$implicit?null:t.context.$implicit.displayTime),n(t,6,0,!t.context.$implicit.isSend),n(t,8,0,t.context.$implicit.isSend)}),(function(n,t){n(t,0,0,"messageid-"+t.context.$implicit.id)}))}function H(n){return l.Lb(0,[l.Hb(671088640,1,{content:0}),l.Hb(671088640,2,{myInput:0}),l.Hb(671088640,3,{footer:0}),(n()(),l.rb(3,0,null,null,6,"ion-header",[],null,null,null,b.wb,b.s)),l.qb(4,49152,null,0,p.D,[l.h,l.k,l.x],null,null),(n()(),l.rb(5,0,null,0,4,"ion-toolbar",[],null,null,null,b.hc,b.db)),l.qb(6,49152,null,0,p.Eb,[l.h,l.k,l.x],null,null),(n()(),l.rb(7,0,null,0,2,"ion-title",[],null,null,null,b.fc,b.bb)),l.qb(8,49152,null,0,p.Cb,[l.h,l.k,l.x],null,null),(n()(),l.Jb(9,0,["",""])),(n()(),l.rb(10,0,null,null,7,"ion-content",[],null,[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.cancelTyping()&&l),l}),b.rb,b.n)),l.qb(11,49152,[[1,4]],0,p.w,[l.h,l.k,l.x],null,null),(n()(),l.rb(12,0,null,0,3,"ion-refresher",[],null,[[null,"ionRefresh"]],(function(n,t,e){var l=!0;return"ionRefresh"===t&&(l=!1!==n.component.doRefresh(e)&&l),l}),b.Nb,b.I)),l.qb(13,49152,null,0,p.fb,[l.h,l.k,l.x],null,null),(n()(),l.rb(14,0,null,0,1,"ion-refresher-content",[["pullingIcon","arrow-dropdown"]],null,null,null,b.Mb,b.J)),l.qb(15,49152,null,0,p.gb,[l.h,l.k,l.x],{pullingIcon:[0,"pullingIcon"]},null),(n()(),l.gb(16777216,null,0,1,null,J)),l.qb(17,278528,null,0,m.i,[l.M,l.J,l.q],{ngForOf:[0,"ngForOf"]},null),(n()(),l.rb(18,0,null,null,18,"ion-footer",[["class","footer-container"]],null,null,null,b.ub,b.q)),l.qb(19,49152,[[3,4],["footer",4]],0,p.B,[l.h,l.k,l.x],null,null),(n()(),l.rb(20,0,null,0,16,"ion-toolbar",[],null,null,null,b.hc,b.db)),l.qb(21,49152,null,0,p.Eb,[l.h,l.k,l.x],null,null),(n()(),l.rb(22,0,null,0,14,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(n,t,e){var i=!0,s=n.component;return"submit"===t&&(i=!1!==l.Db(n,24).onSubmit(e)&&i),"reset"===t&&(i=!1!==l.Db(n,24).onReset()&&i),"submit"===t&&(i=!1!==s.FormSubmit(s.chatBox)&&i),i}),null,null)),l.qb(23,16384,null,0,f.t,[],null,null),l.qb(24,4210688,null,0,f.m,[[8,null],[8,null]],null,null),l.Gb(2048,null,f.b,null,[f.m]),l.qb(26,16384,null,0,f.l,[[4,f.b]],null,null),(n()(),l.rb(27,0,null,null,9,"ion-item",[["no-lines",""]],null,null,null,b.Fb,b.y)),l.qb(28,49152,null,0,p.J,[l.h,l.k,l.x],null,null),(n()(),l.rb(29,0,null,0,3,"ion-button",[["fill","clear"],["item-start",""]],null,[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.showOptions()&&l),l}),b.ib,b.e)),l.qb(30,49152,null,0,p.m,[l.h,l.k,l.x],{fill:[0,"fill"]},null),(n()(),l.rb(31,0,null,0,1,"ion-icon",[["class","footer-btn"],["name","ios-add-circle-outline"]],null,null,null,b.xb,b.t)),l.qb(32,49152,null,0,p.E,[l.h,l.k,l.x],{name:[0,"name"]},null),(n()(),l.rb(33,0,null,0,3,"ion-button",[["fill","clear"],["item-end",""]],null,[[null,"click"]],(function(n,t,e){var l=!0,i=n.component;return"click"===t&&(l=!1!==i.send(i.chatBox)&&l),l}),b.ib,b.e)),l.qb(34,49152,null,0,p.m,[l.h,l.k,l.x],{fill:[0,"fill"]},null),(n()(),l.rb(35,0,null,0,1,"ion-icon",[["class","footer-btn"],["name","send"]],null,null,null,b.xb,b.t)),l.qb(36,49152,null,0,p.E,[l.h,l.k,l.x],{name:[0,"name"]},null)],(function(n,t){var e=t.component;n(t,15,0,"arrow-dropdown"),n(t,17,0,e.messages),n(t,30,0,"clear"),n(t,32,0,"ios-add-circle-outline"),n(t,34,0,"clear"),n(t,36,0,"send")}),(function(n,t){n(t,9,0,t.component.messageTitle),n(t,22,0,l.Db(t,26).ngClassUntouched,l.Db(t,26).ngClassTouched,l.Db(t,26).ngClassPristine,l.Db(t,26).ngClassDirty,l.Db(t,26).ngClassValid,l.Db(t,26).ngClassInvalid,l.Db(t,26).ngClassPending)}))}function j(n){return l.Lb(0,[(n()(),l.rb(0,0,null,null,1,"page-message-chat",[],null,null,null,H,A)),l.qb(1,114688,null,0,y,[p.Mb,p.Lb,f.d,E.a,w.a,h.b,a.a,l.k,u.a,O.a,S.a,c.a,p.b,I.k,_.a,P.a,S.a,g.a,p.a,p.Kb,l.h,T.m,C.a],null,null)],(function(n,t){n(t,1,0)}),null)}var Y=l.nb("page-message-chat",y,j,{},{},[]),K=e("j1ZV"),W=e("FUS3");e.d(t,"MessageChatPageModuleNgFactory",(function(){return V}));var V=l.ob(i,[],(function(n){return l.Ab([l.Bb(512,l.j,l.Z,[[8,[s.a,Y]],[3,l.j],l.v]),l.Bb(4608,m.l,m.k,[l.s,[2,m.A]]),l.Bb(4608,p.c,p.c,[l.x,l.g]),l.Bb(4608,p.Kb,p.Kb,[p.c,l.j,l.p]),l.Bb(4608,p.Ob,p.Ob,[p.c,l.j,l.p]),l.Bb(4608,f.r,f.r,[]),l.Bb(4608,f.d,f.d,[]),l.Bb(4608,I.g,I.f,[]),l.Bb(4608,I.c,I.e,[]),l.Bb(4608,I.i,I.d,[]),l.Bb(4608,I.b,I.a,[]),l.Bb(4608,I.k,I.k,[I.l,I.g,I.c,I.i,I.b,I.m,I.n]),l.Bb(5120,l.d,(function(n,t,e){return[p.Ub(n,t,e)]}),[p.Tb,m.c,l.x]),l.Bb(1073742336,m.b,m.b,[]),l.Bb(1073742336,p.Gb,p.Gb,[]),l.Bb(1073742336,T.n,T.n,[[2,T.t],[2,T.m]]),l.Bb(1073742336,I.h,I.h,[]),l.Bb(1073742336,f.q,f.q,[]),l.Bb(1073742336,f.h,f.h,[]),l.Bb(1073742336,f.o,f.o,[]),l.Bb(1073742336,K.a,K.a,[]),l.Bb(1073742336,W.a,W.a,[]),l.Bb(1073742336,i,i,[]),l.Bb(256,I.n,void 0,[]),l.Bb(256,I.m,void 0,[]),l.Bb(256,p.Tb,void 0,[]),l.Bb(1024,T.k,(function(){return[[{path:"",component:y}]]}),[])])}))}}]);