(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{nLkt:function(n,t,l){"use strict";l.r(t);var e=l("CcnG"),i=function(){return function(){}}(),o=l("pMnS"),s=l("1bmy"),u=l("liwm"),r=l("riPR"),a=l("ZwiA"),c=l("A7o+"),b=l("oBZk"),g=l("ZZ/e"),h=l("Ip0R"),p=function(){function n(n){this.element=n}return n.prototype.ngAfterViewInit=function(){this.badge&&parseInt(this.badge,10)>999&&(this.badge="...")},n}(),d=e.rb({encapsulation:0,styles:[[".info-tip[_ngcontent-%COMP%]{background:#fa3c00;position:absolute;line-height:1.5rem;min-width:1.5rem;min-height:1.5rem;top:-.5rem;right:-.5rem;border-radius:50%;padding:1px;font-size:small}.info[_ngcontent-%COMP%]{position:relative;color:#fff;text-align:center;border-radius:50%;display:inline-block}.avatar[_ngcontent-%COMP%]{border-radius:50%;min-width:40px}"]],data:{}});function m(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,1,"span",[["class","info-tip"]],null,null,null,null,null)),(n()(),e.Lb(1,null,["",""]))],null,(function(n,t){n(t,1,0,t.component.badge)}))}function f(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,3,"div",[["class","info"]],null,null,null,null,null)),(n()(),e.tb(1,0,null,null,0,"img",[["class","avatar"]],[[8,"src",4]],null,null,null,null)),(n()(),e.ib(16777216,null,null,1,null,m)),e.sb(3,16384,null,0,h.j,[e.O,e.L],{ngIf:[0,"ngIf"]},null)],(function(n,t){n(t,3,0,t.component.badge>0)}),(function(n,t){n(t,1,0,e.xb(1,"",t.component.src,""))}))}var M=l("mrSG"),v=l("VvKu"),C=l("yHx4"),k=l("4DE5"),_=l("VGsI"),O=l("fg/S"),S=l("m6VD"),P=function(){function n(n,t,l,e,i,o,s,u,r,a,c,b){this.navCtrl=n,this.messageProvider=t,this.eventsService=l,this.session=e,this.alertCtrl=i,this.translateService=o,this.actionSheetCtrl=s,this.cd=u,this.sqlServiceProvider=r,this.handle=a,this.configProvider=c,this.router=b,this.isDataLoading=!1,this.isDataEmpty=!1,this.page=0,this.pageCount=30,this.isShowCheckBox=!1}return n.prototype.ngOnInit=function(){var n=this,t=this.messageProvider.getMessageSession();t&&t.length>0?this.chats=t:this.initMessage(),this.eventsService.on(v.h.ReceivedNotification,(function(){n.initMessage()})),this.eventsService.on(v.o.LangChangedRefresh,(function(){n.formatGroupsTime()})),this.eventsService.on(v.i.Changed,(function(){n.initMessage()})),this.eventsService.on(v.o.MessageSessionRefresh,(function(){n.initMessage()})),this.eventsService.on(v.f.Initialize,(function(){n.initMessage()}))},n.prototype.detectChange=function(){this.cd.destroyed||this.cd.detectChanges()},n.prototype.openContactList=function(){this.router.navigate(["ContactPage"])},n.prototype.initMessage=function(n){var t=this;this.messageProvider.getMessageChat().subscribe((function(l){t.isDataEmpty=0===l.length,t.chats=l,t.createMessageArray(),n&&n.target.complete()}),(function(n){t.configProvider.initDatabase()}))},n.prototype.openDetails=function(n){this.messageProvider.goMessageList({widgetId:n.id,widgetIcon:n.sessionIcon,widgetName:n.sessionName||"unknown",fromType:n.extra.fromType,messages:[]},this.router)},n.prototype.deleteSession=function(n){this.messageProvider.deleteMessageBySessionId(n.id);var t=this.chats.findIndex((function(t){return t.id===n.id}));this.chats.splice(t,1),this.isMoreData()},n.prototype.updateMessageStatus=function(){this.chats=this.messageProvider.updateGroups(),this.page=0},n.prototype.doRefresh=function(n){this.initMessage(n)},n.prototype.doInfinite=function(n){this.createMessageArray(),setTimeout((function(){n.target.complete()}),1e3)},n.prototype.createMessageArray=function(){this.formatGroupsTime(),this.isMoreData(),this.detectChange()},n.prototype.isMoreData=function(){this.chats.length>0?(this.finiteScroll=!0,this.page++):this.finiteScroll=!1},n.prototype.formatGroupsTime=function(){for(var n=0,t=this.chats;n<t.length;n++){var l=t[n];l.displayTime=_.a.formatMessageGroupTime(this.session.language,Number(l.latestTime)),l.sessionName=this._getWidgetNameById(l.id)||l.sessionName}},n.prototype._getWidgetNameById=function(n){if(!this.session.LangContexts)return"";for(var t=0,l=this.session.LangContexts;t<l.length;t++){var e=l[t];if(n===e.keyId)return e.content}return""},n.prototype.showDeleteMsg=function(n){return M.b(this,void 0,void 0,(function(){var t=this;return M.e(this,(function(l){switch(l.label){case 0:return[4,this.alertCtrl.create({header:this.translateService.instant("MESSAGE_DELETE_TITLE"),message:this.translateService.instant("MESSAGE_DELETE_MESSAGE"),buttons:[{text:this.translateService.instant("MESSAGE_DELETE_CANCEL"),handler:function(){}},{text:this.translateService.instant("MESSAGE_DELETE_CONFIRM"),handler:function(){t.deleteSession(n)}}]})];case 1:return[4,l.sent().present()];case 2:return l.sent(),[2]}}))}))},n.prototype.setStickyOnTop=function(n,t){this.messageProvider.setMessageSessionTopStatusFlag(n,t?0:1),this.createMessageArray()},n}(),x=l("ZYCi"),y=e.rb({encapsulation:0,styles:[[".header-icon[_ngcontent-%COMP%]{width:2.4rem;margin-left:5px}.badge[_ngcontent-%COMP%]:after{content:attr(num);line-height:1.6rem;text-align:center;width:1.6rem;height:1.6rem;border-radius:50%;background-color:red;position:absolute;top:-.5rem;right:-.5rem}.item-ios[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], ion-img[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%}ion-note[slot=end][_ngcontent-%COMP%]{padding-left:8px;margin-left:0}ion-avatar[_ngcontent-%COMP%]{margin-right:8px}.latest-time[_ngcontent-%COMP%]{float:right;font-size:1rem;color:gray}h3[_ngcontent-%COMP%]{color:gray;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.group-title[_ngcontent-%COMP%]{max-width:70%}.theme-light[_ngcontent-%COMP%]   .inner-item[_ngcontent-%COMP%]:active{background:#dfdfdf}.theme-light[_ngcontent-%COMP%]   .sticky-top[_ngcontent-%COMP%]{background-color:#e7e7e7}.theme-light[_ngcontent-%COMP%]   .sticky-top[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{border-bottom:1.2px solid #e7e7e7!important}.theme-dark[_ngcontent-%COMP%]   .inner-item[_ngcontent-%COMP%]:active{background:#424242}.theme-dark[_ngcontent-%COMP%]   .sticky-top[_ngcontent-%COMP%]{background-color:#343434}.theme-dark[_ngcontent-%COMP%]   .sticky-top[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{border-bottom:1.2px solid #343434!important}.sc-ion-label-ios-h[_ngcontent-%COMP%], .sc-ion-label-ios-s[_ngcontent-%COMP%]{margin-left:8px;padding-top:4px;padding-bottom:4px}ion-list[_ngcontent-%COMP%]   ion-item-sliding[_ngcontent-%COMP%]:last-child{border-bottom:var(--border-primary)}ion-list[_ngcontent-%COMP%]   ion-item-sliding[_ngcontent-%COMP%]:last-child   ion-item[_ngcontent-%COMP%]{--inner-border-width:0}"]],data:{}});function E(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,2,"nodata",[["translateKey","MESSAGE_EMPTY"]],null,null,null,s.b,s.a)),e.sb(1,114688,null,0,u.a,[r.a,a.a,e.h,c.k],{text:[0,"text"],translateKey:[1,"translateKey"]},null),e.Gb(131072,c.j,[c.k,e.h])],(function(n,t){n(t,1,0,e.xb(1,"",e.Mb(t,1,0,e.Fb(t,2).transform("MESSAGE_EMPTY")),""),"MESSAGE_EMPTY")}),null)}function D(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,3,"ion-item-option",[["color","medium"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.setStickyOnTop(n.parent.context.$implicit.id,null==n.parent.context.$implicit?null:n.parent.context.$implicit.isTop)&&e),e}),b.Cb,b.z)),e.sb(1,49152,null,0,g.M,[e.h,e.k,e.z],{color:[0,"color"]},null),(n()(),e.Lb(2,0,[" "," "])),e.Gb(131072,c.j,[c.k,e.h])],(function(n,t){n(t,1,0,"medium")}),(function(n,t){n(t,2,0,e.Mb(t,2,0,e.Fb(t,3).transform("MESSAGE_GROUP_STICKY_ON_TOP")))}))}function T(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,3,"ion-item-option",[["color","medium"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.setStickyOnTop(n.parent.context.$implicit.id,null==n.parent.context.$implicit?null:n.parent.context.$implicit.isTop)&&e),e}),b.Cb,b.z)),e.sb(1,49152,null,0,g.M,[e.h,e.k,e.z],{color:[0,"color"]},null),(n()(),e.Lb(2,0,[" "," "])),e.Gb(131072,c.j,[c.k,e.h])],(function(n,t){n(t,1,0,"medium")}),(function(n,t){n(t,2,0,e.Mb(t,2,0,e.Fb(t,3).transform("MESSAGE_GROUP_REMOVE_STICKY")))}))}function I(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,31,"ion-item-sliding",[],null,null,null,b.Eb,b.B)),e.sb(1,49152,null,0,g.O,[e.h,e.k,e.z],null,null),(n()(),e.tb(2,0,null,0,19,"ion-item",[["class","ion-activatable ion-activatable-radius"],["slot","start"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.openDetails(n.context.$implicit)&&e),e}),b.Fb,b.y)),e.sb(3,49152,null,0,g.J,[e.h,e.k,e.z],null,null),e.Ib(512,null,h.v,h.w,[e.s,e.t,e.k,e.D]),e.sb(5,278528,null,0,h.h,[h.v],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Hb(6,{"sticky-top":0}),(n()(),e.tb(7,0,null,0,3,"ion-avatar",[],null,null,null,b.fb,b.b)),e.sb(8,49152,null,0,g.h,[e.h,e.k,e.z],null,null),(n()(),e.tb(9,0,null,0,1,"avatar-badge",[],null,null,null,f,d)),e.sb(10,4243456,null,0,p,[e.k],{src:[0,"src"],badge:[1,"badge"]},null),(n()(),e.tb(11,0,null,0,5,"ion-label",[],null,null,null,b.Gb,b.C)),e.sb(12,49152,null,0,g.P,[e.h,e.k,e.z],null,null),(n()(),e.tb(13,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),e.Lb(14,null,["",""])),(n()(),e.tb(15,0,null,0,1,"h3",[],null,null,null,null,null)),(n()(),e.Lb(16,null,["",""])),(n()(),e.tb(17,0,null,0,2,"ion-note",[["class","latest-time"],["slot","end"]],null,null,null,b.Jb,b.F)),e.sb(18,49152,null,0,g.ab,[e.h,e.k,e.z],null,null),(n()(),e.Lb(19,0,[" "," "])),(n()(),e.tb(20,0,null,0,1,"ion-ripple-effect",[],null,null,null,b.Ob,b.K)),e.sb(21,49152,null,0,g.jb,[e.h,e.k,e.z],null,null),(n()(),e.tb(22,0,null,0,9,"ion-item-options",[["side","end"]],null,null,null,b.Db,b.A)),e.sb(23,49152,null,0,g.N,[e.h,e.k,e.z],{side:[0,"side"]},null),(n()(),e.ib(16777216,null,0,1,null,D)),e.sb(25,16384,null,0,h.j,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.ib(16777216,null,0,1,null,T)),e.sb(27,16384,null,0,h.j,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.tb(28,0,null,0,3,"ion-item-option",[["color","danger"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.showDeleteMsg(n.context.$implicit)&&e),e}),b.Cb,b.z)),e.sb(29,49152,null,0,g.M,[e.h,e.k,e.z],{color:[0,"color"]},null),(n()(),e.Lb(30,0,[" "," "])),e.Gb(131072,c.j,[c.k,e.h])],(function(n,t){var l=n(t,6,0,null==t.context.$implicit?null:t.context.$implicit.isTop);n(t,5,0,"ion-activatable ion-activatable-radius",l),n(t,10,0,null==t.context.$implicit?null:t.context.$implicit.sessionIcon,e.xb(1,"",null==t.context.$implicit?null:t.context.$implicit.unreadCount,"")),n(t,23,0,"end"),n(t,25,0,!(null!=t.context.$implicit&&t.context.$implicit.isTop)),n(t,27,0,null==t.context.$implicit?null:t.context.$implicit.isTop),n(t,29,0,"danger")}),(function(n,t){n(t,14,0,null==t.context.$implicit?null:t.context.$implicit.sessionName),n(t,16,0,null==t.context.$implicit?null:t.context.$implicit.latestMessageTitle),n(t,19,0,null==t.context.$implicit?null:t.context.$implicit.displayTime),n(t,30,0,e.Mb(t,30,0,e.Fb(t,31).transform("MESSAGE_GROUP_DELETE")))}))}function w(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,7,"ion-header",[],null,null,null,b.wb,b.s)),e.sb(1,49152,null,0,g.D,[e.h,e.k,e.z],null,null),(n()(),e.tb(2,0,null,0,5,"ion-toolbar",[],null,null,null,b.hc,b.db)),e.sb(3,49152,null,0,g.Eb,[e.h,e.k,e.z],null,null),(n()(),e.tb(4,0,null,0,3,"ion-title",[["class","title"]],null,null,null,b.fc,b.bb)),e.sb(5,49152,null,0,g.Cb,[e.h,e.k,e.z],null,null),(n()(),e.Lb(6,0,["",""])),e.Gb(131072,c.j,[c.k,e.h]),(n()(),e.tb(8,0,null,null,11,"ion-content",[],null,null,null,b.rb,b.n)),e.sb(9,49152,null,0,g.w,[e.h,e.k,e.z],null,null),(n()(),e.tb(10,0,null,0,3,"ion-refresher",[["slot","fixed"]],null,[[null,"ionRefresh"]],(function(n,t,l){var e=!0;return"ionRefresh"===t&&(e=!1!==n.component.doRefresh(l)&&e),e}),b.Nb,b.I)),e.sb(11,49152,null,0,g.fb,[e.h,e.k,e.z],null,null),(n()(),e.tb(12,0,null,0,1,"ion-refresher-content",[["pullingIcon","arrow-dropdown"]],null,null,null,b.Mb,b.J)),e.sb(13,49152,null,0,g.gb,[e.h,e.k,e.z],{pullingIcon:[0,"pullingIcon"]},null),(n()(),e.tb(14,0,null,0,5,"ion-list",[],null,null,null,b.Ib,b.D)),e.sb(15,49152,null,0,g.Q,[e.h,e.k,e.z],null,null),(n()(),e.ib(16777216,null,0,1,null,E)),e.sb(17,16384,null,0,h.j,[e.O,e.L],{ngIf:[0,"ngIf"]},null),(n()(),e.ib(16777216,null,0,1,null,I)),e.sb(19,278528,null,0,h.i,[e.O,e.L,e.s],{ngForOf:[0,"ngForOf"]},null)],(function(n,t){var l=t.component;n(t,13,0,"arrow-dropdown"),n(t,17,0,l.isDataEmpty),n(t,19,0,l.chats)}),(function(n,t){n(t,6,0,e.Mb(t,6,0,e.Fb(t,7).transform("MESSAGE_TITLE")))}))}function G(n){return e.Nb(0,[(n()(),e.tb(0,0,null,null,1,"page-message-session",[],null,null,null,w,y)),e.sb(1,114688,null,0,P,[g.Lb,O.a,r.a,a.a,g.b,c.k,g.a,e.h,S.a,k.a,C.a,x.m],null,null)],(function(n,t){n(t,1,0)}),null)}var L=e.pb("page-message-session",P,G,{},{},[]),z=l("gIcY"),$=l("j1ZV");l.d(t,"MessageSessionPageModuleNgFactory",(function(){return N}));var N=e.qb(i,[],(function(n){return e.Cb([e.Db(512,e.j,e.bb,[[8,[o.a,L]],[3,e.j],e.x]),e.Db(4608,h.l,h.k,[e.u,[2,h.A]]),e.Db(4608,g.c,g.c,[e.z,e.g]),e.Db(4608,g.Kb,g.Kb,[g.c,e.j,e.q]),e.Db(4608,g.Ob,g.Ob,[g.c,e.j,e.q]),e.Db(4608,z.r,z.r,[]),e.Db(4608,z.d,z.d,[]),e.Db(4608,c.g,c.f,[]),e.Db(4608,c.c,c.e,[]),e.Db(4608,c.i,c.d,[]),e.Db(4608,c.b,c.a,[]),e.Db(4608,c.k,c.k,[c.l,c.g,c.c,c.i,c.b,c.m,c.n]),e.Db(5120,e.d,(function(n,t,l){return[g.Ub(n,t,l)]}),[g.Tb,h.c,e.z]),e.Db(1073742336,h.b,h.b,[]),e.Db(1073742336,g.Gb,g.Gb,[]),e.Db(1073742336,x.n,x.n,[[2,x.t],[2,x.m]]),e.Db(1073742336,c.h,c.h,[]),e.Db(1073742336,z.q,z.q,[]),e.Db(1073742336,z.h,z.h,[]),e.Db(1073742336,z.o,z.o,[]),e.Db(1073742336,$.a,$.a,[]),e.Db(1073742336,i,i,[]),e.Db(256,c.n,void 0,[]),e.Db(256,c.m,void 0,[]),e.Db(256,g.Tb,void 0,[]),e.Db(1024,x.k,(function(){return[[{path:"",component:P}]]}),[])])}))}}]);