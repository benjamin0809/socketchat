{"version":3,"sources":["../../src/pages/common/img-viewer/img-viewer.module.ts","../../src/pages/common/img-viewer/img-viewer.ts"],"names":[],"mappings":"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","file":"96.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ImgViewerPage } from './img-viewer';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ImgViewerPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ImgViewerPage),\r\n    TranslateModule.forChild()\r\n  ],\r\n  exports: [ImgViewerPage]\r\n})\r\nexport class ImgViewerPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/common/img-viewer/img-viewer.module.ts","import { Events } from 'ionic-angular';\r\nimport { DEFAULT_LOGO } from './../../../services/constants';\r\nimport { PreloadProvider } from './../../../providers/preload-provider';\r\nimport { WidgetProvider } from './../../../providers/widget-provider';\r\nimport { CacheProvider } from './../../../providers/cache-provider';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Component, ViewChild, ElementRef } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ActionSheetController } from 'ionic-angular';\r\nimport { ViewController } from 'ionic-angular/navigation/view-controller'; \r\nimport { Webpage } from '../../../models/models';  \r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-img-viewer',\r\n  templateUrl: 'img-viewer.html',\r\n})\r\nexport class ImgViewerPage {\r\n\r\n  @ViewChild('panel') panel: ElementRef;\r\n  swiper: any;\r\n  tapImageCount: number = 0; \r\n  timer:any;\r\n  vm: any = {\r\n    selectedIndex: 0,\r\n    images: [],\r\n  }\r\n\r\n\r\n  constructor(public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public viewCtrl: ViewController,\r\n    public actionSheetCtrl: ActionSheetController,\r\n    public translateService: TranslateService,\r\n    public cacheProvider: CacheProvider,\r\n    public widgetProvider: WidgetProvider,\r\n    public preload: PreloadProvider,\r\n    public events: Events\r\n  ) {\r\n \r\n    this.vm.images = this.navParams.data.imageArray;\r\n    this.vm.selectedIndex = this.navParams.data.index;\r\n  }\r\n\r\n  ionViewDidLoad() { \r\n    this.swiper = new Swiper(this.panel.nativeElement, {\r\n      initialSlide: this.vm.selectedIndex,//初始化显示第几个\r\n      direction: 'horizontal',\r\n      zoom: true,//双击,手势缩放\r\n      loop: false,//循环切换\r\n      lazyLoading: true,//延迟加载\r\n      lazyLoadingOnTransitionStart: true,// \r\n      pagination: '.swiper-pagination',//分页器\r\n      paginationType: 'fraction',//分页器类型\r\n      navigation: {\r\n        nextEl: '.swiper-button-next',\r\n        prevEl: '.swiper-button-prev',\r\n      },\r\n      on: {\r\n        slideChange: () => {\r\n          if (this.swiper) {\r\n            let activeIndex = this.swiper.activeIndex;\r\n            if (activeIndex < this.vm.images.length && activeIndex >= 0) {\r\n              this.vm.selectedIndex = activeIndex;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n\r\n  close() {\r\n    // this.events.publish('backbutton' );\r\n    this.tapImageCount ++;\r\n    this.timer && clearTimeout(this.timer)\r\n    this.timer = setTimeout(()=>{\r\n      if(this.tapImageCount < 2){  \r\n        this.timer && clearTimeout(this.timer)\r\n        this.viewCtrl.dismiss({ImgViewerDismiss:true }) \r\n      }\r\n      this.tapImageCount = 0;\r\n    },50)\r\n     \r\n  }\r\n\r\n  onHold(image) {\r\n    let that = this;\r\n    let sheet = null;\r\n\r\n    let buttons = [];\r\n \r\n    buttons.push({\r\n      text: that.translateService.instant('SHARE_MODAL_TITLE'),\r\n      handler: () => {\r\n        that.openSharePage(image.pictureUrl);\r\n      }\r\n    })\r\n \r\n    buttons.push({\r\n      text: that.translateService.instant('MESSAGE_DELETE_CANCEL'),\r\n      role: 'cancel'\r\n    })\r\n    \r\n    //长按时同时识别图片中是否存在二维码，若存在，则增加 识别二维码选项\r\n    this.cacheProvider.decodeQRCode(image.pictureUrl).subscribe(decodeResult => {\r\n      buttons.splice(buttons.length - 1, 1, {\r\n        text: that.translateService.instant('APP_COMMON_EXTRACT_QRCODE'),\r\n        handler: () => {\r\n          that.openQRCodeUrl(decodeResult);\r\n        }\r\n      })\r\n      buttons.push({\r\n        text: that.translateService.instant('MESSAGE_DELETE_CANCEL'),\r\n        role: 'cancel'\r\n      })\r\n\r\n      let newsheet = that.actionSheetCtrl.create({ buttons: buttons });\r\n      newsheet.present();\r\n      sheet && sheet.dismiss()\r\n    },err=>{\r\n      sheet = that.actionSheetCtrl.create({ buttons: buttons });\r\n      sheet.present();\r\n    })\r\n  }\r\n  /**\r\n  * 打开分享页面\r\n  */\r\n  openSharePage(imageUrl) {\r\n\r\n    let shareMessage = {\r\n      title: '', //标题\r\n      description: '', //描述\r\n      thumb: imageUrl || DEFAULT_LOGO, //缩略图\r\n      resource: imageUrl //图片url或网页url\r\n    }\r\n\r\n    this.preload.openShareModal({\r\n      shareMessage: shareMessage,\r\n      isShareImage: true,\r\n      navigationDockTargetMapIds: [1, 2]\r\n    })\r\n  }\r\n\r\n  openQRCodeUrl(imgMsg) {\r\n    let page: Webpage = {\r\n      url: imgMsg,  // 链接地址\r\n      title: '', // 标题\r\n      description: '',   // 摘要内容\r\n      imageUrl: '',   // 图片路径\r\n      appId: '',  // 應用ID\r\n      options: {\r\n\r\n      }\r\n    };\r\n    this.widgetProvider.openWebpage(page, this.navCtrl);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/common/img-viewer/img-viewer.ts"],"sourceRoot":""}