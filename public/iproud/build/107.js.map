{"version":3,"sources":["../../src/pages/beta/speech/speech.module.ts","../../src/pages/beta/speech/speech.ts"],"names":[],"mappings":"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","file":"107.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { SpeechPage } from './speech';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SpeechPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SpeechPage),\r\n  ],\r\n})\r\nexport class SpeechPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/beta/speech/speech.module.ts","import { Session } from './../../../services/session';\r\n \r\nimport { HttpService } from './../../../services/http-service';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { File, FileEntry } from '@ionic-native/file'\r\n/**\r\n * Generated class for the SpeechPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-speech',\r\n  templateUrl: 'speech.html',\r\n})\r\nexport class SpeechPage {\r\n \r\n  fileName: string = 'myfile'; \r\n  replace:boolean = false;\r\n  directory: string;\r\n  directorys: any;\r\n  token: string;\r\n  speech:string;\r\n  len:number = 0;\r\n  format:string = 'pcm'\r\n  formats : any\r\n  constructor(public navCtrl: NavController, \r\n    public navParams: NavParams,\r\n    public httpService: HttpService,\r\n    public session: Session,\r\n    public file: File) {\r\n      this.directorys =[{\r\n        name:'dataDirectory',\r\n        path:this.file.dataDirectory\r\n      },{\r\n        name:'cacheDirectory',\r\n        path:this.file.cacheDirectory\r\n      },{\r\n        name:'externalApplicationStorageDirectory',\r\n        path:this.file.externalApplicationStorageDirectory\r\n      },{\r\n        name:'externalDataDirectory',\r\n        path:this.file.externalDataDirectory\r\n      },{\r\n        name:'externalCacheDirectory',\r\n        path:this.file.externalCacheDirectory\r\n      },{\r\n        name:'externalRootDirectory',\r\n        path:this.file.externalRootDirectory\r\n      } ]\r\n\r\n      this.directory = this.file.externalRootDirectory\r\n      this.formats = [{\r\n        name:'pcm'\r\n      },{\r\n        name:'wav'\r\n      },{\r\n        name:'amr'\r\n      }]\r\n  }\r\n\r\n  ionViewDidLoad() { \r\n  }\r\n \r\n\r\n\r\n  getToken(){\r\n    let grant_type ='client_credentials';\r\n    let client_id = 'mp1tCx8l9n3gaBfAZqcoOV5j';\r\n    let client_secret = 'eoqmIbUX9Oht9uXmoeSZZnHLHRfeznc4' \r\n    let url = `https://aip.baidubce.com/oauth/2.0/token?grant_type=${grant_type}&client_id=${client_id}&client_secret=${client_secret}` ;\r\n    let seq = this.httpService.post(url, false, null, true).share();\r\n   \r\n    seq.subscribe(result =>{\r\n      // alert(JSON.stringify(result))\r\n      if(result.errcode == 0){\r\n        this.token =  result.result.access_token \r\n      }else {\r\n        alert('http error')\r\n      }\r\n    },error=>{\r\n      alert(JSON.stringify(error))\r\n    })\r\n    return seq;\r\n  }\r\n\r\n  goAnalysis(){\r\n    const index = this.speech.indexOf('base64,')\r\n    const prestr = this.speech.substring(0,index)\r\n\r\n    this.speech = this.speech.replace(prestr + 'base64,' , '');\r\n    let body = {\r\n      format:this.format,\r\n      rate:\"16000\", \r\n      channel:\"1\",\r\n      token:this.token,\r\n      cuid:\"465551225465\",\r\n      len:this.len,\r\n      speech:this.speech\r\n      \r\n    }\r\n\r\n     \r\n    alert(\"body : \" + JSON.stringify(body))\r\n \r\n \r\n    this.httpService.post('https://vop.baidu.com/server_api',false,body).subscribe(res=>{\r\n      alert(JSON.stringify(res))\r\n      if(res.errcode == 0){\r\n         \r\n      }else {\r\n        alert('request error')\r\n      }\r\n    },err=>{\r\n      alert(JSON.stringify(err))\r\n    })\r\n  }\r\n\r\n  toBase64(){\r\n\r\n    alert(this.directory)\r\n    let directory = this.directory;\r\n    if(this.replace){\r\n      directory = this.directory.replace(/^file:\\/\\//, '');\r\n    }\r\n    let _this = this;\r\n    this.file.resolveLocalFilesystemUrl(directory + this.fileName + \".\"+this.format).then((fileEnter: FileEntry) => {\r\n      fileEnter.file(file => {\r\n          \r\n          let reader = new FileReader();\r\n          reader.onloadend = function (e) {\r\n              // alert(this.result);\r\n              _this.speech = this.result.toString();\r\n          };\r\n          reader.readAsDataURL(file);\r\n\r\n          let reader2 = new FileReader();\r\n          reader2.onloadend = function (e) {\r\n            // alert(this.result.toString().length);\r\n            _this.len = this.result.toString().length;\r\n          };\r\n          reader2.readAsBinaryString(file);\r\n \r\n      });\r\n  }).catch(err => { \r\n      alert(JSON.stringify(err))\r\n  });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/beta/speech/speech.ts"],"sourceRoot":""}