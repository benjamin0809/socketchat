{"version":3,"sources":["../../src/pages/my/settings/settings.module.ts","../../src/pages/my/settings/settings.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAyC;AACa;AACN;AAEN;AACkB;AAc5D;IAAA;IAAkC,CAAC;IAAtB,kBAAkB;QAb9B,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,+DAAY;aACb;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,+DAAY,CAAC;gBACtC,4EAAe,CAAC,QAAQ,EAAE;gBAC1B,wEAAW;aACZ;YACD,OAAO,EAAE;gBACP,+DAAY;aACb;SACF,CAAC;OACW,kBAAkB,CAAI;IAAD,yBAAC;CAAA;AAAJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBqC;AAEd;AACgB;AACA;AACqC;AACvC;AACO;AACjC;AACc;AACD;AAC2B;AACb;AACQ;AAE7E;;;;GAIG;AAMH;IAiBE,sBAAmB,OAAsB,EAChC,QAAyB,EACzB,WAAwB,EACxB,SAAoB,EACpB,SAA2B,EAC3B,cAA8B,EAC9B,YAA0B,EAC1B,SAA0B,EAC1B,MAAc,EACd,OAAgB,EAChB,aAA4B,EAC5B,aAA4B,EAC5B,YAA0B,EAC1B,cAA8B,EAC9B,cAA8B,EAC9B,cAA8B;QAfvC,iBAiCC;QAjCkB,YAAO,GAAP,OAAO,CAAe;QAChC,aAAQ,GAAR,QAAQ,CAAiB;QACzB,gBAAW,GAAX,WAAW,CAAa;QACxB,cAAS,GAAT,SAAS,CAAW;QACpB,cAAS,GAAT,SAAS,CAAkB;QAC3B,mBAAc,GAAd,cAAc,CAAgB;QAC9B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,cAAS,GAAT,SAAS,CAAiB;QAC1B,WAAM,GAAN,MAAM,CAAQ;QACd,YAAO,GAAP,OAAO,CAAS;QAChB,kBAAa,GAAb,aAAa,CAAe;QAC5B,kBAAa,GAAb,aAAa,CAAe;QAC5B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,mBAAc,GAAd,cAAc,CAAgB;QAC9B,mBAAc,GAAd,cAAc,CAAgB;QAC9B,mBAAc,GAAd,cAAc,CAAgB;QA5BvC,YAAO,GAAW,4EAAe,CAAC,MAAM,CAAC;QACzC,kBAAa,GAAG,KAAK,CAAC;QACtB,eAAU,GAAY,KAAK,CAAC;QAC5B,gBAAW,GAAY,KAAK,CAAC;QAC7B,cAAS,GAAW,CAAC,CAAC;QAGtB,YAAO,GAAY,KAAK,CAAC;QACzB,WAAM,GAAY,KAAK,CAAC;QACxB,cAAS,GAAQ,sEAAS,CAAC;QAE3B,mBAAc,GAAW,aAAa,CAAC;QACvC,aAAQ,GAAU,EAAE,CAAC;QAmBnB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC;QAC3C,IAAI,CAAC,MAAM,GAAG,oEAAO,CAAC;QACtB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC;QACzC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,mBAAmB,EAAE;YACzC,KAAI,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc;QAEvD,GAAG,EAAY,UAA4B,EAA5B,WAAM,CAAC,IAAI,CAAC,4EAAe,CAAC,EAA5B,cAA4B,EAA5B,IAA4B;YAAvC,IAAI,GAAG;YACT,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;gBACjB,KAAK,EAAG,GAAG;gBACX,KAAK,EAAG,4EAAe,CAAC,GAAG,CAAC;aAC7B,CAAC;SACH;IACH,CAAC;IAED,iCAAU,GAAV;QAAA,iBAgEC;QA/DC,IAAI,KAAK,GAAQ;YACf,WAAW,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;YACvC,aAAa,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC;YAC3C,mBAAmB,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC;YACvD,WAAW,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;YACvC,mBAAmB,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC;YACvD,cAAc,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC;YAC7E,kBAAkB,EAAG,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC;SAEvD,CAAC;QAEF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAG1C,kCAAkC;QAClC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,CAAC;YACjC,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,YAAY,CAAC,SAAS,CAAC,eAAK;YAChE,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,SAAS,CAAC,cAAI;YAC3D,KAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;YAC3B,KAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,EAAC,KAAK,CAAC,CAAC;YAC/C,KAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,SAAQ;QAC1C,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,YAAY,CAAC,SAAS,CAAC,eAAK;YACjE,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC,CAAC,SAAS;QAC1D,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,eAAK;YACzD,yDAAyD;YACzD,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YAC9C,IAAI,OAAO,GAAG,EAAE,CAAC;YACjB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACV,OAAO,GAAG,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,2BAA2B,CAAC;YAC/D,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,GAAG,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,6BAA6B,CAAC;YACjE,CAAC;YAED,KAAI,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,SAAS,CAAC,eAAK;YAC3D,KAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,KAAI,CAAC,cAAc,CAAC,YAAY,GAAG,KAAK;YACxC,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,KAAI,CAAC,OAAO,CAAC,MAAM,GAAG,SAAS,EAAE,KAAI,CAAC,OAAO,CAAC,CAAC;YAC3E,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,KAAI,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;YACxD,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,EAAC,KAAK,EAAC,KAAI,CAAC,OAAO,CAAC;QAC1D,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,eAAK;YACzD,KAAI,CAAC,OAAO,CAAC,UAAU,GAAG,KAAK,CAAC;YAChC,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;YAClD,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,sBAAsB,EAAE,KAAK,CAAC;YAElD,QAAQ;YACR,YAAY,CAAC,KAAI,CAAC,KAAK,CAAC;YACxB,KAAI,CAAC,KAAK,GAAG,UAAU,CAAC;gBACtB,KAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,EAAE,MAAM,EAAE,UAAU,EAAE,OAAO,EAAE,kEAAO,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,IAAI;gBAChH,CAAC,CAAC,CAAC;YACL,CAAC,EAAE,IAAI,CAAC;QACV,CAAC,CAAC,CAAC;IAGL,CAAC;IAED,qCAAc,GAAd;QACE,iDAAiD;QACjD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QAEvC,2BAA2B;IAC7B,CAAC;IAED,uCAAgB,GAAhB;QAAA,iBA2BC;QA1BC,iDAAiD;QACjD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;YACxB,KAAI,CAAC,aAAa,GAAG,IAAI,CAAC;YAC1B,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,QAAQ,CAAC,WAAW,CAAC;YACzC,KAAI,CAAC,OAAO,CAAC,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC;YACvD,KAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC,CAAC,CAAC,KAAK,CAAC;YACP,KAAI,CAAC,aAAa,GAAG,IAAI,CAAC;YAC1B,KAAI,CAAC,OAAO,GAAG;gBACb,mBAAmB,EAAE,IAAI;gBACzB,cAAc,EAAE,OAAO;gBACvB,mBAAmB,EAAE,IAAI;gBACzB,WAAW,EAAE,KAAK;gBAClB,WAAW,EAAE,qEAAQ;gBACrB,kBAAkB,EAAE,IAAI;aACzB;YACD,KAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,wEAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,UAAC,WAAW;YACxE,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC;gBAAC,WAAW,GAAG,CAAC,CAAC;YAClC,KAAI,CAAC,SAAS,GAAG,WAAW,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC;IAC5C,CAAC;IAED,kCAAW,GAAX;IACA,CAAC;IAED,aAAa;IACb,kCAAW,GAAX;QAAA,iBAyCC;QAxCC,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAElC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,uBAAuB,CAAC;YACtD,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,qBAAqB,CAAC;YACtD,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,mBAAmB,CAAC;oBACjD,IAAI,EAAE,QAAQ;iBACf;gBACD;oBACE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,oBAAoB,CAAC;oBAClD,OAAO,EAAE;wBAEP,0CAA0C;wBAC1C,wDAAwD;wBAExD,QAAQ;wBACR,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC;wBAEhD,SAAS;wBAET,SAAS;wBACT,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC,CAAC;wBAChD,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAAC;wBAEnD,YAAY;wBACZ,KAAI,CAAC,aAAa,CAAC,eAAe,EAAE,CAAC;wBAErC,KAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC;wBACxC,KAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAC,SAAS,CAAC,aAAG;4BAChD,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC;wBAC9E,CAAC,EAAE,eAAK;4BACN,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;wBACvB,CAAC,CAAC;oBAEJ,CAAC;iBACF;aACF;SACF,CAAC,CAAC;QACH,OAAO,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAGD,oCAAa,GAAb;QACE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAE,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC5E,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,EAAC,IAAI,CAAC,WAAW,EAAC,IAAI,CAAC,OAAO,CAAC;IACrE,CAAC;IACK,sCAAe,GAArB;;;;;4BACgB,qBAAM,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAE,SAAS,CAAC;;wBAA3E,OAAO,GAAG,SAAiE;wBAC7D,qBAAM,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC;;wBAApE,WAAW,GAAG,SAAsD;wBACxE,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;4BAChB,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;wBACjC,CAAC;wBACD,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;4BACZ,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;wBACzB,CAAC;;;;;KACF;IAED,wCAAiB,GAAjB;QACE,gCAAgC;QAChC,+BAA+B;QAC/B,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAEpC,6CAA6C;IAC/C,CAAC;IA/NU,YAAY;QAJxB,gEAAS,CAAC;YACT,QAAQ,EAAE,eAAe;WACG;SAC7B,CAAC;2FAkByC;YACtB,oEAAe;YACZ,kEAAW;YACb,6EAAS;YACT,4EAAgB;YACX,4EAAc;YAChB,uEAAY;YACf,+DAAe;YAClB,oEAAM;YACL,yEAAO;YACD,gFAAa;YACb,yEAAa;YACd,kFAAY;YACV,kFAAc;YACd,kFAAc;YACd,SAAc;OAhC5B,YAAY,CAkOxB;IAAD,CAAC;AAAA;SAlOY,YAAY,e","file":"54.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { SettingsPage } from './settings';\r\nimport { PipesModule } from './../../../pipes/pipes.module';\r\n@NgModule({\r\n  declarations: [\r\n    SettingsPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SettingsPage),\r\n    TranslateModule.forChild(),\r\n    PipesModule\r\n  ],\r\n  exports: [\r\n    SettingsPage\r\n  ]\r\n})\r\nexport class SettingsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my/settings/settings.module.ts","\r\nimport { ConfigProvider } from '../../../providers/config-provider';\r\n\r\nimport { Utility } from './../../../services/utility';\r\nimport { ServerProvider } from './../../../providers/server-provider';\r\nimport { WidgetProvider } from './../../../providers/widget-provider';\r\nimport { IS_DEBUG, LANGUAGES, IS_BETA, OPEN_WIDGET_WAY, STORAGE_KEY } from './../../../services/constants';\r\nimport { CacheProvider } from './../../../providers/cache-provider';\r\nimport { NativeService, JPushService } from './../../../services/services';\r\nimport { Component } from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, Events } from 'ionic-angular';\r\nimport { Session, StorageService } from '../../../services/services';\r\nimport { SettingProvider, UserProvider } from '../../../providers/providers';\r\nimport { Message } from '../../../models/models';\r\n/**\r\n * The Settings page is a simple form that syncs with a Settings provider\r\n * to enable the user to customize settings for the app.\r\n *\r\n */\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-settings',\r\n  templateUrl: 'settings.html'\r\n})\r\nexport class SettingsPage {\r\n  // Our local settings object\r\n  options: any;\r\n  message: Message;\r\n  openWay: string = OPEN_WIDGET_WAY.IFRAME;\r\n  settingsReady = false;\r\n  isEmployee: Boolean = false;\r\n  browserCore: boolean = false;\r\n  cacheSize: number = 0;\r\n  form: FormGroup;\r\n  userId: string;\r\n  isAdmin: boolean = false;\r\n  isBeta: boolean = false;\r\n  languages: any = LANGUAGES;\r\n  timer: any;\r\n  browserCoreKey: string = 'browserCore'; \r\n  openWays: any[] = [];\r\n  constructor(public navCtrl: NavController,\r\n    public settings: SettingProvider,\r\n    public formBuilder: FormBuilder,\r\n    public navParams: NavParams,\r\n    public translate: TranslateService,\r\n    public storageService: StorageService,\r\n    public userProvider: UserProvider,\r\n    public alertCtrl: AlertController,\r\n    public events: Events,\r\n    public session: Session,\r\n    public nativeService: NativeService,\r\n    public cacheProvider: CacheProvider,\r\n    public jpushService: JPushService,\r\n    public widgetProvider: WidgetProvider,\r\n    public serverProvider: ServerProvider,\r\n    public configProvider: ConfigProvider, \r\n  ) {\r\n\r\n    this.isAdmin = this.navParams.data.isAdmin;\r\n    this.isBeta = IS_BETA;\r\n    this.userId = this.navParams.data.userId;\r\n    this.events.subscribe('cache:clear-image', () => {\r\n      this.cacheSize = 0;\r\n    });\r\n    this.initBrowserCore();\r\n    this.browserCoreKey = this.userId + this.browserCoreKey\r\n \r\n    for(let key of Object.keys(OPEN_WIDGET_WAY)){\r\n      this.openWays.push({\r\n        label : key,\r\n        value : OPEN_WIDGET_WAY[key],\r\n      })\r\n    }\r\n  }\r\n\r\n  _buildForm() {\r\n    let group: any = {\r\n      optionDebug: [this.options.optionDebug],\r\n      optionBrowser: [this.options.optionBrowser],\r\n      optionShowFabButton: [this.options.optionShowFabButton],\r\n      optionTheme: [this.options.optionTheme],\r\n      optionReceiveNotify: [this.options.optionReceiveNotify],\r\n      optionLanguage: [this.navParams.data.language || this.options.optionLanguage],\r\n      isCollectErrorInfo:  [this.options.isCollectErrorInfo],\r\n      //deleteCache: [this.options.deleteCache]\r\n    };\r\n\r\n    this.form = this.formBuilder.group(group);\r\n\r\n\r\n    // Watch the form for changes, and\r\n    this.form.valueChanges.subscribe((v) => {\r\n      this.settings.merge(this.form.value);\r\n    });\r\n    this.form.controls.isCollectErrorInfo.valueChanges.subscribe(value => {\r\n      this.storageService.setItem(\"isCollectErrorInfo\", value);\r\n    });\r\n    this.form.controls.optionLanguage.valueChanges.subscribe(lang => { \r\n      this.session.widget = null;\r\n      this.configProvider.changeLanguage(lang,false);\r\n      this.userProvider.getUserInfo();//刷新个人信息\r\n    });\r\n    this.form.controls.optionShowFabButton.valueChanges.subscribe(value => {\r\n      this.events.publish('setting:changed', value); //需要刷新设置 \r\n    });\r\n    this.form.controls.optionDebug.valueChanges.subscribe(value => {\r\n      // this.events.publish('setting:changed',value); //需要刷新版本\r\n      this.storageService.setItem(\"isdebug\", value);\r\n      let message = \"\";\r\n      if (value) {\r\n        message = this.translate.instant('VERSION_EXCHANGE_TO_DEBUG')\r\n      } else {\r\n        message = this.translate.instant('VERSION_EXCHANGE_TO_RELEASE')\r\n      }\r\n\r\n      this.nativeService.showToast(message);\r\n    });\r\n    this.form.controls.optionBrowser.valueChanges.subscribe(value => {\r\n      this.browserCore = value; \r\n      this.widgetProvider.innerBrowser = value\r\n      this.storageService.setItem(this.session.userId + \"openWay\", this.openWay);\r\n      this.storageService.setItem(this.browserCoreKey, value);\r\n      this.events.publish('change:openWay',value,this.openWay)\r\n    });\r\n\r\n    this.form.controls.optionTheme.valueChanges.subscribe(value => {\r\n      this.session.isDarkMode = value;\r\n      this.storageService.setItem(\"optionTheme\", value);\r\n      this.events.publish('setting:change-theme', value)\r\n\r\n      //延时保存主题\r\n      clearTimeout(this.timer)\r\n      this.timer = setTimeout(() => {\r\n        this.userProvider.privateSetting([{ \"name\": \"appTheme\", \"value\": Utility.getThemeName(value) }]).subscribe((data) => {\r\n        });\r\n      }, 3000)\r\n    });\r\n\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    // Build an empty form for the template to render\r\n    this.form = this.formBuilder.group({});\r\n\r\n    // this.testSaveDeviceId();\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    // Build an empty form for the template to render\r\n    this.form = this.formBuilder.group({});\r\n    this.settings.load().then(() => {\r\n      this.settingsReady = true;\r\n      this.options = this.settings.allSettings;\r\n      this.options.optionDebug = this.serverProvider.isDebug;\r\n      this._buildForm();\r\n    }).catch(() => {\r\n      this.settingsReady = true;\r\n      this.options = {\r\n        optionReceiveNotify: true,\r\n        optionLanguage: 'en-US',\r\n        optionShowFabButton: true,\r\n        optionTheme: false,\r\n        optionDebug: IS_DEBUG,\r\n        isCollectErrorInfo: true\r\n      }\r\n      this._buildForm();\r\n    });\r\n\r\n    this.storageService.getItem(STORAGE_KEY.DATA.CACHE_SIZE).then((cacheResult) => {\r\n      if (!cacheResult) cacheResult = 0;\r\n      this.cacheSize = cacheResult;\r\n    });\r\n\r\n    this.isEmployee = this.session.isEmployee;\r\n  }\r\n\r\n  ngOnChanges() {\r\n  }\r\n\r\n  //清除缓存--删除消息 \r\n  deleteCache() {\r\n    let confirm = this.alertCtrl.create({\r\n\r\n      title: this.translate.instant('SETTINGS_DELETE_CACHE'),\r\n      message: this.translate.instant('SETTINGS_CACHE_INFO'),\r\n      buttons: [\r\n        {\r\n          text: this.translate.instant('APP_COMMON_CANCEL'),\r\n          role: 'Cancel'\r\n        },\r\n        {\r\n          text: this.translate.instant('APP_COMMON_CONFIRM'),\r\n          handler: () => {\r\n\r\n            //2019-1-14 by zhaogx do not clear message\r\n            // this.events.publish('message:clear-all', Date.now());\r\n\r\n            //清除搜索记录\r\n            this.storageService.setItem(\"HistorySearch\", [])\r\n\r\n            //清除搜索记录 \r\n\r\n            //清除悬浮球信息\r\n            this.storageService.setItem(\"touch-coords\", \"\");\r\n            this.storageService.setItem(\"isShowFabButton\", \"\");\r\n\r\n            /**清除图片缓存 */\r\n            this.cacheProvider.clearImageCache();\r\n\r\n            this.widgetProvider.clearBrowserCache();\r\n            this.userProvider.clearMemberCache().subscribe(res => {\r\n              this.nativeService.alert(this.translate.instant('SETTINGS_CACHE_COMPLETE'));\r\n            }, error => {\r\n              console.error(error);\r\n            })\r\n\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    confirm.present();\r\n  }\r\n\r\n\r\n  changeOpenWay(){ \r\n    this.storageService.setItem( this.session.userId + \"openWay\", this.openWay);\r\n    this.events.publish('change:openWay',this.browserCore,this.openWay)\r\n  }\r\n  async initBrowserCore() {\r\n    let openWay = await this.storageService.getItem(this.session.userId +\"openWay\")\r\n    let browserCore = await this.storageService.getItem(this.browserCoreKey)\r\n    if (browserCore) {\r\n      this.browserCore = browserCore;\r\n    }\r\n    if (openWay) {\r\n      this.openWay = openWay;\r\n    } \r\n  }\r\n\r\n  getRegistrationID() {\r\n    //this.jpushService.initJpush();\r\n    // this.jpushService.count = 0;\r\n    this.jpushService.getDeviceId(true);\r\n\r\n    // this.storageService.removeItem('homedata')\r\n  }\r\n\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my/settings/settings.ts"],"sourceRoot":""}