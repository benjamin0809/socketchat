{"version":3,"sources":["../../src/pages/my/security/security.module.ts","../../src/pages/my/security/security.ts"],"names":[],"mappings":"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","file":"55.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { SecurityPage } from './security';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SecurityPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SecurityPage),\r\n    TranslateModule.forChild()\r\n  ],\r\n  exports: [\r\n    SecurityPage\r\n  ]\r\n})\r\nexport class SecurityPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my/security/security.module.ts","import { SqliteProvider } from './../../../providers/sqlite-provider';\r\nimport { StorageService } from './../../../services/storage-service';\r\nimport { ENABLE_ELECTRONIC_SIGNATURE } from './../../../services/constants';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { NativeService } from './../../../services/native-service';\r\nimport { AuthProvider } from './../../../providers/auth-provider';\r\nimport { UserProvider } from './../../../providers/user-provider';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, ModalController, NavController, AlertController, Events } from 'ionic-angular';\r\nimport { Session } from '../../../services/services';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-security',\r\n  templateUrl: 'security.html'\r\n})\r\nexport class SecurityPage {\r\n  currentUser: any;\r\n  isBindWeChat: boolean = false\r\n  enableElectronicSign = ENABLE_ELECTRONIC_SIGNATURE;\r\n\r\n  constructor(public navCtrl: NavController,\r\n    public session: Session,\r\n    public modalCtrl: ModalController,\r\n    public userProvider: UserProvider,\r\n    public authProvider: AuthProvider,\r\n    public nativeService: NativeService,\r\n    public translate: TranslateService,\r\n    private alert: AlertController,\r\n    private storageService: StorageService,\r\n    private events: Events,\r\n    private sqliteProvider: SqliteProvider\r\n    ) {\r\n    if (this.session.user != null) {\r\n      this.currentUser = this.session.user;\r\n\r\n      this.isBindWeChat = this.currentUser.nickNameWX || this.currentUser.headImgUrlWX\r\n    }\r\n\r\n  }\r\n\r\n  goChangePassword() {\r\n    this.navCtrl.push('ChangePasswordPage');\r\n  }\r\n  goSetPassword() {\r\n    this.navCtrl.push('SetPasswordPage');\r\n  }\r\n\r\n  async BindWeChat(){\r\n    const code = await this.authProvider.getWeChatCode()\r\n    this.userProvider.BindWechat(code).subscribe(res=>{\r\n      this.currentUser.nickNameWX = res.result.nickName\r\n      this.currentUser.headImgUrlWX = res.result.headImgUrl\r\n\r\n      this.isBindWeChat = this.currentUser.nickNameWX || this.currentUser.headImgUrlWX\r\n\r\n      this.nativeService.showToast(this.translate.instant('BINDING_SUCCESS'))\r\n    },err=>{\r\n      console.error(err)\r\n    })\r\n  }\r\n\r\n  UnBindWechat(){\r\n    this.userProvider.UnBindWechat().subscribe(res=>{ \r\n      this.isBindWeChat = false;\r\n\r\n      this.nativeService.showToast(this.translate.instant('UNBIND_SUCCESS'))\r\n    },err=>{\r\n      console.error(err)\r\n    })\r\n  }\r\n\r\n  goCerificiate() {\r\n    this.navCtrl.push('CertificatePage')\r\n  }\r\n  AccountCancellation(){\r\n    const alert = this.alert.create({\r\n      title: this.translate.instant('CANCELACCOUNT'),\r\n      subTitle: \"\",\r\n      message: this.translate.instant('CANCELACCOUNT_TIPS'),\r\n      buttons: [{\r\n        text: this.translate.instant('MESSAGE_DELETE_CANCEL'),\r\n        role: 'cancel' \r\n      },\r\n      {\r\n        text: this.translate.instant('MESSAGE_DELETE_CONFIRM'),\r\n        handler: () => {\r\n          this.userProvider.CancelAccount().subscribe(res => {\r\n            this.storageService.removeItem(\"userId\");\r\n            this.storageService.removeItem('token');\r\n            this.storageService.removeItem('refreshtoken');\r\n            this.storageService.removeItem('tokenObject');\r\n            this.storageService.removeItem('homedata');\r\n            this.session.token = null;\r\n            this.session.userId = null;\r\n            this.session.user = null;\r\n            this.session.refreshToken = null;\r\n            this.session.homedata = null;\r\n            this.session.unionId = null;\r\n            this.events.publish('user:reLogin', Date.now());\r\n            this.sqliteProvider.closeUserDataBase();\r\n            this.nativeService.showToast(this.translate.instant('CANCELACCOUNT_SUCCESS'))\r\n          });\r\n        }\r\n      }\r\n    ]\r\n    })\r\n    alert.present()\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/my/security/security.ts"],"sourceRoot":""}